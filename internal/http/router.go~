package http

import (
	"net/http"

	"github.com/go-chi/chi/v5"
	"pr-reviewer/internal/handlers"
)

func NewRouter(
	userHandler *handlers.UsersHandler,
	teamHandler *handlers.TeamsHandler,
	prHandler *handlers.PRHandler,
) http.Handler {

	r := chi.NewRouter()

	// Users
	// POST /users/setIsActive
	r.Post("/users/setIsActive", userHandler.SetIsActive)
	r.Get("/users/getReview", prHandler.GetPRsByReviewer)

	r.Post("/users", userHandler.CreateUser)
	r.Get("/users", userHandler.ListUsers)
	r.Get("/users/{id}", userHandler.GetUser)
	r.Put("/users/{id}", userHandler.UpdateUser)
	r.Delete("/users/{id}", userHandler.DeleteUser)

	// Teams
	// POST /team/add
	r.Post("/team/add", teamHandler.AddTeam)
	r.Post("/team", teamHandler.CreateTeam)
	r.Get("/teams", teamHandler.ListTeams)
	r.Get("/teams/{name}", teamHandler.GetTeam)
	r.Delete("/teams/{name}", teamHandler.DeleteTeam)

	// Pull Requests
	r.Post("/pullRequest/create", prHandler.CreatePR)
	r.Post("/pullRequest/reassign", prHandler.ReassignReviewer)
	r.Post("/pullRequest/merge", prHandler.MergePR)

	r.Get("/pullRequest/{id}", prHandler.GetPR)

	return r
}
